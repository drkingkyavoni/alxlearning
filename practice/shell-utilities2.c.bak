#include "main.h"

/**
 * get_ssize - function to get size of string
 * @s: char pointer
 * Return: ssize_t
*/
size_t get_ssize(char *s)
{
	size_t i;
	for (i = 0; s[i] != '\0'; i++)
		;
	return (i);
}

/**
 * _perror - print error
 * @msg: char pointer
 * Return: void
*/
void _perror(char *msg)
{
	perror(msg);
	exit(EXIT_FAILURE);
}

/**
 * create_tokens - function to create tokens from line buffer
 * @buf: const char pointer
 * @i: ssize_t
 * @pt: struct ptoken_t pointer
 * Return: int
*/
int create_tokens(char *buf, token_t *pt)
{
	if (!buf) /* check if buffer is empty */
		return (-1);

	pt->elements = 0;

	if (nullterminate(buf, get_ssize(buf), pt) == -1)
	{
		free(buf);
		_perror("Error: failed to null terminate line buffer");
	}

	return (0);
}


/**
 * nullterminate - replaces all spaces with delimiter
 * @buffer: char pointer
 * @token: struct token_t
 * Return: int
*/
int nullterminate(char *buffer, size_t n, token_t *token)
{
    size_t i, *word_size, counter = 0, word_index = 0;
    char *word = NULL, **words = NULL;

    word = malloc(sizeof(char) * n);
    words = malloc(sizeof(char *) * n);
    word_size = malloc(sizeof(size_t) * n);

    if (!word || !words || !word_size)
        perror("Error: failed to allocate memory");

    for (i = 0; i < n; i++) {
        if (buffer[i] != token->delim && buffer[i] != '\n') {
            word[counter] = buffer[i];
            counter++;
        } else {
            if (!counter)
                continue;

            word[counter] = '\0';
            token->words[word_index] = word;
            token->word_size[word_index] = counter;
            token->elements++;

            printf("Elements: %ld\n", token->elements);
            printf("Word size: %ld\n", token->word_size[word_index]);
            printf("Word: %s\n", token->words[word_index]);

            word_index++;
            counter = 0; /* reset counter */
        }
    }

    free(word);
    token->elements = word_index;
    _realloc(token);

    return ((!token->words) ? -1 : 0);
}

/**
 * _realloc - function to realloc token pointer
 *
 * @token: struct token_t
 * Return: void
 */
void _realloc(token_t *token)
{
    char **words;
    size_t *word_size;

    if (!token || !token->words || !token->word_size)
        perror("Error: token is empty");

    words = realloc(token->words, sizeof(char *) * token->elements);
    word_size = realloc(token->word_size, sizeof(size_t) * token->elements);

    if (!words || !word_size)
        perror("Error: failed to realloc token arrays");

    token->words = words;
    token->word_size = word_size;
}